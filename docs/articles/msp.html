<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Model stability plots • mplot</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">mplot</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Theory
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/background.html">Background and philosophy</a>
    </li>
    <li>
      <a href="../articles/vip.html">Variable inclusion plots</a>
    </li>
    <li>
      <a href="../articles/msp.html">Model stability plots</a>
    </li>
    <li>
      <a href="../articles/af.html">Adaptive fence</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Applications
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/diabetes.html">Diabetes</a>
    </li>
    <li>
      <a href="../articles/birthweight.html">Birth weight</a>
    </li>
    <li>
      <a href="../articles/artificial.html">Artificial example</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tips
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/interactive.html">Interactive plots</a>
    </li>
    <li>
      <a href="../articles/timing.html">Timing</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/garthtarr/mplot">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/people.html">
    <span class="fa fa-info-circle fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Model stability plots</h1>
            
          </div>

    
    
<div class="contents">
<blockquote>
<p>Overview of model stability plots.</p>
</blockquote>
<p>In order to generate model stability and variable inclusion plots, the first step is to generate a <code>vis</code> object using the <code><a href="../reference/vis.html">vis()</a></code> function. To generate a <code>vis</code> object for the artificial data example the fitted full model object along with some optional arguments are passed to the <code><a href="../reference/vis.html">vis()</a></code> function.</p>
<div class="sourceCode"><pre class="sourceCode s"><code class="sourceCode gnuassembler">lm.art = lm(y ~ ., data = artificialeg)
vis.art = vis(lm.art, B = <span class="dv">150</span>, redundant = TRUE, nbest = <span class="st">"all"</span>)</code></pre></div>
<div id="fig:plotvis">
<p><img src="images/plotvis.png"></p>
</div>
<p><em>Figure: results of calls to <code>plot(vis.art, interactive = FALSE)</code> with additional arguments <code>which = "lvk"</code> in the top left, <code>which = "boot"</code> in the top right and <code>which = "vip"</code> down the bottom.</em></p>
<p>The <code>B = 150</code> argument provided to the <code><a href="../reference/vis.html">vis()</a></code> function tells us that we want to perform 150 bootstrap replications. See <span class="citation">Murray et al. (2013)</span> for more detail on the use of exponential weights in bootstrap model selection. Specifying <code>redundant = TRUE</code> is unnecessary, as it is the default option; it ensures that an extra variable, randomly generated from a standard normal distribution and hence completely unrelated to the true data generating process, is added to the full model. This extra redundant variable can be used as a baseline comparison in the variable inclusion plots. Finally, the <code>nbest</code> argument controls how many models with the smallest <span class="math inline">\(\hat{Q}(\alpha)\)</span> for each model size <span class="math inline">\(k=1,\ldots,p\)</span> are recorded. It can take an integer argument or specifying <code>nbest = "all"</code> ensures that all possible models are displayed when the plot methods is called, as shown in the top left panel of the <a href="#fig:plotvis">figure above</a>. Typically researchers do not need to visualise the entire model space and in problems with larger numbers of candidate variables it is impractical to store and plot results for all models. The default behaviour of the <code><a href="../reference/vis.html">vis()</a></code> function is to set <code>nbest = 5</code>, essentially highlighting the maximum enveloping lower convex curve of <span class="citation">Murray et al. (2013)</span>.</p>
<p>The simplest visualisation of the model space is to plot a measure of description loss against model complexity for all possible models, a special implementation is the Mallows <span class="math inline">\(C_p\)</span> plot <span class="citation">(Mallows, 2000)</span>. This is done using the argument <code>which = "lvk"</code> to the plot function applied to a <code>vis</code> object. The string <code>"lvk"</code> is short for loss versus <span class="math inline">\(k\)</span>, the dimension of the model.</p>
<div class="sourceCode"><pre class="sourceCode s"><code class="sourceCode gnuassembler">plot(vis.art, interactive = FALSE, highlight = <span class="st">"x8"</span>, which = <span class="st">"lvk"</span>)</code></pre></div>
<p>The result of this function can be found in the top left panel of the <a href="#fig:plotvis">figure above</a>. The <code>highlight</code> argument is used to differentiate models that contain a particular variable from those that do not. This is an implementation of the <em>enriched scatter plot</em> of <span class="citation">Murray et al. (2013)</span>. There is a clear separation between models that contain <span class="math inline">\(x_8\)</span> and those that do not, that is, all triangles are clustered towards the bottom with the circles above in a separate cluster. There is no similar separation for the other explanatory variables (not shown). These results strongly suggest that <span class="math inline">\(x_8\)</span> is the single most important variable. For clarity the points have been jittered slightly along the horizontal axis, though the model sizes remain clearly differentiated.</p>
<p>Rather than performing a single pass over the model space and plotting the description loss against model size, a more nuanced and discerning approach is to use a (exponential weighted) bootstrap to determine how often various models achieve the minimal loss for each model size. The advantage of the bootstrap approach is that it gives a measure of model stability for each model size as promoted by <span class="citation">Meinshausen &amp; Bühlmann (2010)</span>, <span class="citation">Müller &amp; Welsh (2010)</span> and <span class="citation">Murray et al. (2013)</span>.</p>
<p>The weighted bootstrap has two key-benefits over the residual or nonparametric bootstrap: First, the weighted bootstrap always yields observable responses which is particularly relevant when these observable values are restricted to be integers (as in many generalized linear models), or, when <span class="math inline">\(y\)</span> values are naturally bounded, say to be observed on the interval 0 to 1; Second, the weighted bootstrap does not suffer from separation issues that regularly occur in logistic and other models. The pairs bootstrap also yields observable responses and can be thought of as a special (boundary) case of the weighted bootstrap where some weights are allowed to be exactly zero, which can create a separation issue in logistic models. Therefore, we have chosen to implement the weighted bootstrap because it is a simple, elegant method that appears to work well. Specifically, we utilise the exponential weighted bootstrap where the observations are reweighted with weights drawn from an exponential distribution with mean 1 <span class="citation">(see Murray et al., 2013)</span>.</p>
<p>To visualise the results of the exponential weighted bootstrap, the <code>which = "boot"</code> argument needs to be passed to the plot call on a <code>vis</code> object. The <code>highlight</code> argument can again be used to distinguish between models with and without a particular variable. Each circle represents a model with a non-zero bootstrap probability, that is, each model that was selected as the best model of a particular dimension in at least one bootstrap replication. Furthermore, the area of each circle is proportional to the corresponding model’s bootstrapped selection probability.</p>
<p>The top right panel of the <a href="#fig:plotvis">figure above</a> is an example of a model stability plot for the artificial data set. The null model, the full model and the simple linear regression of <span class="math inline">\(y\)</span> on <span class="math inline">\(x_8\)</span> all have bootstrap probabilities equal to one. While there are alternatives to the null and full model their inclusion in the plot serves two main purposes. Firstly, to gauge the potential range in description loss and secondly to provide a baseline against which to compare other circles to see if any approach a similar size, which would indicate that those are dominant models of a given model dimension. In the <a href="#fig:plotvis">figure above</a>, for model dimensions of between three and ten, there are no clearly dominant models, that is, within each model size there are no models that are selected much more commonly than the alternatives.</p>
<p>A print method is available for <code>vis</code> objects which prints the model formula, log-likelihood and proportion of times that a given model was selected as the <em>best</em> model within each model size. The default minimum probability of a model being selected before it gets printed is 0.3, though this can be customised by passing a <code>min.prob</code> argument to the <code>print</code> function.</p>
<div class="sourceCode"><pre class="sourceCode s"><code class="sourceCode gnuassembler">print(vis.art, min.prob = <span class="dv">0</span>.25)</code></pre></div>
<pre><code>                         name prob logLikelihood
                          y~1 1.00       -135.33
                         y~x8 1.00       -105.72
                      y~x4+x8 0.40       -103.63
                      y~x1+x8 0.27       -104.47
    y~x1+x2+x3+x4+x5+x6+x7+x9 0.26       -100.63
 y~x1+x2+x3+x4+x5+x6+x7+x9+RV 0.33       -100.51</code></pre>
<p>The output above, reinforces what we know from the top right panel of the <a href="#fig:plotvis">figure above</a>. The null model is always selected and in models of size two a regression of <span class="math inline">\(y\)</span> on <span class="math inline">\(x_8\)</span> is always selected. In models of size three the two most commonly selected models are <code>y~x4+x8</code>, which was selected 40% of the time and <code>y~x1+x8</code> selected in 27% of bootstrap replications. Interestingly, in models of size nine and ten, the most commonly selected models do not contain <span class="math inline">\(x_8\)</span>, these are shown as blue circles in the plot. We will see in the next section that this phenomenon is related to the failure of stepwise variable selection with this data set.</p>
<div id="references" class="section level4 unnumbered">
<h4 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h4>
<div id="refs" class="references">
<div id="ref-Mallows:2000">
<p>Mallows, C. L. (2000). Some comments on <span class="math inline">\(C_p\)</span>. <em>Technometrics</em>, 42(1), 87–94. DOI:<a href="https://doi.org/10.1080/00401706.2000.10485984">10.1080/00401706.2000.10485984</a></p>
</div>
<div id="ref-Meinshausen:2010">
<p>Meinshausen, N., &amp; Bühlmann, P. (2010). Stability selection. <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, 72(4), 417–473. DOI:<a href="https://doi.org/10.1111/j.1467-9868.2010.00740.x">10.1111/j.1467-9868.2010.00740.x</a></p>
</div>
<div id="ref-Murray:2013">
<p>Murray, K., Heritier, S., &amp; Müller, S. (2013). Graphical tools for model selection in generalized linear models. <em>Statistics in Medicine</em>, 32(25), 4438–4451. DOI:<a href="https://doi.org/10.1002/sim.5855">10.1002/sim.5855</a></p>
</div>
<div id="ref-Mueller:2010">
<p>Müller, S., &amp; Welsh, A. H. (2010). On model selection curves. <em>International Statistical Review</em>, 78(2), 240–256. DOI:<a href="https://doi.org/10.1111/j.1751-5823.2010.00108.x">10.1111/j.1751-5823.2010.00108.x</a></p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Garth Tarr, Samuel Mueller, Alan H Welsh.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
